% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/up_joint.R
\name{up_chromy_joint}
\alias{up_chromy_joint}
\title{Joint Inclusion Probabilities for Chromy Sampling}
\usage{
up_chromy_joint(x, n, nsim = 10000L)
}
\arguments{
\item{x}{Numeric vector of positive size measures.}

\item{n}{Sample size.}

\item{nsim}{Number of simulations (default 10000).}
}
\value{
A symmetric N×N matrix of joint inclusion probabilities.
Diagonal entries are first-order probabilities π_k.
}
\description{
Estimates joint inclusion probabilities for Chromy's sequential PPS
sampling via Monte Carlo simulation.
}
\details{
Chromy's method with randomization has all π_kl > 0, enabling unbiased
variance estimation. Chauvet (2019) derived exact formulas requiring
O(N³) computation; this function uses simulation instead.

Standard error of estimated π_kl ≈ sqrt(π_kl(1-π_kl)/nsim).
With nsim=10000, SE ≈ 0.005 for π_kl ≈ 0.5.
}
\examples{
x <- c(10, 20, 15, 25, 30)
joint <- up_chromy_joint(x, n = 3, nsim = 5000)

# Diagonal ≈ first-order probabilities
pik <- 3 * x / sum(x)
diag(joint)  # Should be close to pik

}
\references{
Chauvet, G. (2019). Properties of Chromy's sampling procedure.
\emph{arXiv:1912.10896}.
}
\seealso{
\code{\link[=up_chromy]{up_chromy()}} for sampling, \code{\link[=up_brewer_joint]{up_brewer_joint()}} for an
analytical approximation suitable for high-entropy designs.
}
