% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inclusion_prob.R
\name{inclusion_prob}
\alias{inclusion_prob}
\title{Compute Inclusion Probabilities from Measure of Size}
\usage{
inclusion_prob(a, n)
}
\arguments{
\item{a}{A numeric vector of positive size measures (e.g., population,
revenue, area). Negative values are treated as zero (with a warning).}

\item{n}{The desired sample size (sum of inclusion probabilities).}
}
\value{
A numeric vector of inclusion probabilities between 0 and 1 that
sum to n. Units with very large size measures may have probability 1
(certainty selections).
}
\description{
Converts a measure of size (MOS) into first-order inclusion probabilities
that sum to the desired sample size n.
}
\details{
The algorithm:
\enumerate{
\item Compute initial probabilities: \eqn{\pi_k = n \cdot a_k / \sum a_k}
\item If any \eqn{\pi_k \geq 1}, set to 1 and redistribute remaining
sample size to other units
\item Iterate until all \eqn{\pi_k} are in the valid range
}

This is the standard "probability proportional to size" (PPS) approach
with automatic handling of certainty selections.
}
\examples{
# Simple example
size <- c(10, 20, 30, 40)
pik <- inclusion_prob(size, n = 2)
pik
sum(pik)  # Should be 2

# With certainty selections (large units)
size <- c(1, 1, 1, 100)  # Unit 4 is much larger
pik <- inclusion_prob(size, n = 2)
pik  # Unit 4 gets probability 1

# Use with sampling
set.seed(42)
population_size <- c(500, 1200, 800, 3000, 600)
pik <- inclusion_prob(population_size, n = 3)
idx <- up_maxent(pik)
idx  # Selected indices

}
\seealso{
\code{\link[=up_maxent]{up_maxent()}}, \code{\link[=up_brewer]{up_brewer()}}, \code{\link[=up_systematic]{up_systematic()}} for sampling
with these inclusion probabilities
}
