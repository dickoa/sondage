% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/unequal_prob.R
\name{unequal_prob_wr}
\alias{unequal_prob_wr}
\title{Unequal Probability Sampling With Replacement}
\usage{
unequal_prob_wr(
  hits,
  method = c("chromy", "multinomial"),
  nrep = 1L,
  prn = NULL,
  ...
)
}
\arguments{
\item{hits}{A numeric vector of expected hits (expected number of
selections per unit). Typically computed via \code{\link[=expected_hits]{expected_hits()}}.
\code{sum(hits)} must be close to a positive integer.}

\item{method}{The sampling method:
\describe{
\item{\code{"chromy"}}{Chromy's (1979) sequential PPS with minimum
replacement. Default method in SAS SURVEYSELECT. Pairwise
expectations \eqn{E(n_i n_j)} are estimated by simulation;
see \code{\link[=joint_expected_hits]{joint_expected_hits()}}. Complexity: O(N + n).}
\item{\code{"multinomial"}}{Multinomial PPS (independent draws).
Units can be selected any number of times. Pairwise expectations
are exact: \eqn{E(n_i n_j) = n(n-1) p_i p_j}.
Complexity: O(n).}
}}

\item{nrep}{Number of replicate samples (default 1).}

\item{prn}{Optional vector of permanent random numbers for sample
coordination. Not currently used by any WR method; a warning is
issued if provided.}

\item{...}{Additional arguments passed to methods.}
}
\value{
An object of class \code{c("unequal_prob", "wr", "sondage_sample")}.
When \code{nrep = 1}, \verb{$sample} is an integer vector and \verb{$hits} is an
integer vector. When \code{nrep > 1}, \verb{$sample} is a matrix (n x nrep) and
\verb{$hits} is a matrix (N x nrep).
}
\description{
Draws a sample with unequal selection probabilities, with replacement
or minimum replacement.
}
\examples{
x <- c(40, 80, 50, 60, 70)
hits <- expected_hits(x, n = 3)

set.seed(42)
s <- unequal_prob_wr(hits, method = "chromy")
s$sample
s$hits

}
\references{
Chromy, J.R. (1979). Sequential sample selection methods.
\emph{Proceedings of the Survey Research Methods Section, ASA}, 401-406.

Chromy, J.R. (2009). Some generalizations of the Horvitz-Thompson
estimator. \emph{Memorial JSM}.
}
\seealso{
\code{\link[=unequal_prob_wor]{unequal_prob_wor()}} for without-replacement designs,
\code{\link[=expected_hits]{expected_hits()}} to compute expected hits from size measures.
}
