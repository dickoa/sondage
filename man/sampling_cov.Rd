% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R
\name{sampling_cov}
\alias{sampling_cov}
\alias{sampling_cov.wor}
\alias{sampling_cov.wr}
\title{Sampling Covariance Matrix}
\usage{
sampling_cov(x, ...)

\method{sampling_cov}{wor}(x, scaled = FALSE, ...)

\method{sampling_cov}{wr}(x, scaled = FALSE, ...)
}
\arguments{
\item{x}{A sampling design object (class \code{"sondage_sample"}).}

\item{...}{Additional arguments passed to \code{\link[=joint_inclusion_prob]{joint_inclusion_prob()}} or
\code{\link[=joint_expected_hits]{joint_expected_hits()}}.}

\item{scaled}{If \code{FALSE} (default), returns the raw covariance matrix.
If \code{TRUE}, returns the scaled check quantities used in the
Sen-Yates-Grundy variance estimator.}
}
\value{
A symmetric N x N matrix. For WOR designs with \code{scaled = FALSE},
off-diagonal entries are typically negative for well-behaved designs.
With \code{scaled = TRUE}, off-diagonal entries are typically non-positive.
}
\description{
Computes the sampling covariance matrix used in variance estimation.
}
\details{
For without-replacement designs:
\eqn{\Delta_{ij} = \pi_{ij} - \pi_i \pi_j}.

For with-replacement designs:
\eqn{E(n_i n_j) - E(n_i) E(n_j)}.

When \code{scaled = TRUE}, returns the Sen-Yates-Grundy check quantities:
\eqn{1 - \pi_i \pi_j / \pi_{ij}} for WOR,
\eqn{1 - E(n_i) E(n_j) / E(n_i n_j)} for WR.
}
\examples{
pik <- c(0.2, 0.3, 0.5)
s <- unequal_prob_wor(pik, method = "cps")

# Raw covariance
sampling_cov(s)

# SYG check quantities
sampling_cov(s, scaled = TRUE)

}
\references{
Chromy, J.R. (2009). Some generalizations of the Horvitz-Thompson
estimator. \emph{Memorial JSM}.

Tille, Y. (2006). \emph{Sampling Algorithms}. Springer.
}
