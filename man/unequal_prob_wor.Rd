% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/unequal_prob.R
\name{unequal_prob_wor}
\alias{unequal_prob_wor}
\title{Unequal Probability Sampling Without Replacement}
\usage{
unequal_prob_wor(
  pik,
  method = c("cps", "brewer", "systematic", "poisson", "sps", "pareto"),
  nrep = 1L,
  prn = NULL,
  ...
)
}
\arguments{
\item{pik}{A numeric vector of inclusion probabilities.
For fixed-size methods, \code{sum(pik)} must be close to an integer.}

\item{method}{The sampling method:
\describe{
\item{\code{"cps"}}{Conditional Poisson Sampling (maximum entropy).
Fixed sample size, exact inclusion probabilities,
all joint probabilities positive.}
\item{\code{"brewer"}}{Brewer's draw-by-draw method.
Fixed sample size, exact inclusion probabilities,
all joint probabilities positive, order invariant.}
\item{\code{"systematic"}}{Systematic PPS sampling. Fixed sample size,
O(N) time. Some joint probabilities may be zero.}
\item{\code{"poisson"}}{Poisson sampling. Random sample size. Each unit
selected independently with probability \eqn{\pi_k}.}
\item{\code{"sps"}}{Sequential Poisson Sampling (Ohlsson, 1998).
Fixed sample size, high-entropy design. Supports permanent
random numbers (PRN) for sample coordination.}
\item{\code{"pareto"}}{Pareto sampling (Rosen, 1997). Fixed sample size,
high-entropy design. Supports PRN for sample coordination.
Uses the odds-ratio ranking function.}
}}

\item{nrep}{Number of replicate samples (default 1). When \code{nrep > 1},
returns a matrix (fixed-size) or list (random-size) instead of a
design object.}

\item{prn}{Optional vector of permanent random numbers (length N,
values in the open interval (0, 1)) for sample coordination.
Supported by methods \code{"sps"}, \code{"pareto"}, and \code{"poisson"}.
When \code{NULL}, random numbers are generated internally.}

\item{...}{Additional arguments passed to methods (e.g., \code{eps} for
boundary tolerance).}
}
\value{
When \code{nrep = 1}: an object of class
\code{c("unequal_prob", "wor", "sondage_sample")}.
When \code{nrep > 1}: a matrix (n x nrep) for fixed-size methods,
or a list of integer vectors for random-size methods.
}
\description{
Draws a sample with unequal inclusion probabilities, without replacement.
}
\examples{
pik <- c(0.2, 0.4, 0.6, 0.8)

# Conditional Poisson Sampling
set.seed(123)
s <- unequal_prob_wor(pik, method = "cps")
s$sample

# Brewer's method
s <- unequal_prob_wor(pik, method = "brewer")
s$sample

# Sequential Poisson Sampling with PRN coordination
prn <- runif(4)
s <- unequal_prob_wor(pik, method = "sps", prn = prn)
s$sample

# Pareto sampling
s <- unequal_prob_wor(pik, method = "pareto", prn = prn)
s$sample

# Batch mode for simulations
sim <- unequal_prob_wor(pik, method = "cps", nrep = 1000)
dim(sim)  # 2 x 1000

}
\references{
Chen, S. X., Dempster, A. P., & Liu, J. S. (1994). Weighted finite
population sampling to maximize entropy. \emph{Biometrika}, 81(3),
457-469.

Brewer, K.R.W. (1963). A model of systematic sampling with unequal
probabilities. \emph{Australian Journal of Statistics}, 5, 5-13.

Ohlsson, E. (1998). Sequential Poisson sampling. \emph{Journal of
Official Statistics}, 14(2), 149-162.

Rosen, B. (1997). On sampling with probability proportional to size.
\emph{Journal of Statistical Planning and Inference}, 62(2), 159-191.

Tille, Y. (2006). \emph{Sampling Algorithms}. Springer.
}
\seealso{
\code{\link[=unequal_prob_wr]{unequal_prob_wr()}} for with-replacement designs,
\code{\link[=equal_prob_wor]{equal_prob_wor()}} for equal probability designs,
\code{\link[=inclusion_prob]{inclusion_prob()}} to compute inclusion probabilities from size measures.
}
