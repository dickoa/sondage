% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/unequal_prob.R
\name{unequal_prob_wor}
\alias{unequal_prob_wor}
\title{Unequal Probability Sampling Without Replacement}
\usage{
unequal_prob_wor(
  pik,
  method = c("cps", "brewer", "systematic", "poisson", "sps", "pareto"),
  nrep = 1L,
  prn = NULL,
  ...
)
}
\arguments{
\item{pik}{A numeric vector of inclusion probabilities.
For fixed-size methods, \code{sum(pik)} must be close to an integer.}

\item{method}{The sampling method:
\describe{
\item{\code{"cps"}}{Conditional Poisson Sampling (maximum entropy design;
Chen, Dempster & Liu, 1994). Fixed sample size, exact first-order
inclusion probabilities. Joint inclusion probabilities are exact
(computed from the CPS design matrix); all \eqn{\pi_{ij} > 0}.
Complexity: O(N^2).}
\item{\code{"brewer"}}{Brewer's (1963) draw-by-draw method. Fixed sample
size, exact first-order inclusion probabilities. Joint inclusion
probabilities are \emph{approximated} via the high-entropy
approximation (see \code{\link[=joint_inclusion_prob]{joint_inclusion_prob()}}). Complexity: O(Nn).}
\item{\code{"systematic"}}{Systematic PPS sampling. Fixed sample size,
exact first-order inclusion probabilities. Joint inclusion
probabilities are exact but \strong{some may be zero} (pairs of
units that can never co-occur in the same systematic sample).
This makes the Sen-Yates-Grundy variance estimator inapplicable;
see \code{\link[=sampling_cov]{sampling_cov()}}. Complexity: O(N).}
\item{\code{"poisson"}}{Poisson sampling. \strong{Random} sample size
(expected size \eqn{n = \sum \pi_k}). Each unit is selected
independently with probability \eqn{\pi_k}, so joint inclusion
probabilities are exact: \eqn{\pi_{ij} = \pi_i \pi_j}.
Supports PRN for sample coordination. Complexity: O(N).
Note: the realized sample size varies across draws and may
occasionally be zero, particularly when inclusion probabilities
are small.}
\item{\code{"sps"}}{Sequential Poisson Sampling (Ohlsson, 1998).
Implemented as order sampling (Rosen, 1997) with ranking key
\eqn{\xi_k = u_k / \pi_k}: the \eqn{n} units with the smallest
\eqn{\xi_k} are selected. This is equivalent to Ohlsson's
sequential threshold adjustment. Fixed sample size, high-entropy
design. Supports PRN for sample coordination. First-order
inclusion probabilities are approximately (not exactly) equal
to the target \code{pik} for finite populations; see
\code{\link[=inclusion_prob]{inclusion_prob()}}. Joint inclusion probabilities are
\emph{approximated} via the high-entropy approximation.
Complexity: O(N log N).}
\item{\code{"pareto"}}{Pareto sampling (Rosen, 1997). Order sampling
with odds-ratio ranking key
\eqn{\xi_k = [u_k/(1-u_k)] / [\pi_k/(1-\pi_k)]}. Fixed sample
size, high-entropy design. Supports PRN for sample coordination.
First-order inclusion probabilities are approximately (not
exactly) equal to the target \code{pik} for finite populations; see
\code{\link[=inclusion_prob]{inclusion_prob()}}. Joint inclusion probabilities are
\emph{approximated} via the high-entropy approximation.
Complexity: O(N log N).}
}}

\item{nrep}{Number of replicate samples (default 1). When \code{nrep > 1},
\verb{$sample} holds a matrix (fixed-size) or list (random-size) of all
replicates. The design object and all generics remain usable.}

\item{prn}{Optional vector of permanent random numbers (length N,
values in the open interval (0, 1)) for sample coordination.
Supported by methods \code{"sps"}, \code{"pareto"}, and \code{"poisson"}.
When \code{NULL}, random numbers are generated internally.
Cannot be used with \code{nrep > 1} (identical PRN would produce
identical replicates). Use a loop with different PRN vectors
for coordinated repeated sampling.}

\item{...}{Additional arguments passed to methods (e.g., \code{eps} for
boundary tolerance).}
}
\value{
An object of class \code{c("unequal_prob", "wor", "sondage_sample")}.
When \code{nrep = 1}, \verb{$sample} is an integer vector of selected unit indices.
When \code{nrep > 1}, \verb{$sample} is a matrix (n x nrep) for fixed-size methods,
or a list of integer vectors of varying lengths for random-size methods (\code{"poisson"}).
}
\description{
Draws a sample with unequal inclusion probabilities, without replacement.
}
\examples{
pik <- c(0.2, 0.4, 0.6, 0.8)

# Conditional Poisson Sampling
set.seed(123)
s <- unequal_prob_wor(pik, method = "cps")
s$sample

# Brewer's method
s <- unequal_prob_wor(pik, method = "brewer")
s$sample

# Sequential Poisson Sampling with PRN coordination
prn <- runif(4)
s <- unequal_prob_wor(pik, method = "sps", prn = prn)
s$sample

# Pareto sampling
s <- unequal_prob_wor(pik, method = "pareto", prn = prn)
s$sample

\donttest{
# Batch mode for simulations
sim <- unequal_prob_wor(pik, method = "cps", nrep = 1000)
dim(sim$sample)  # 2 x 1000
}

}
\references{
Chen, S. X., Dempster, A. P., & Liu, J. S. (1994). Weighted finite
population sampling to maximize entropy. \emph{Biometrika}, 81(3),
457-469.

Brewer, K.R.W. (1963). A model of systematic sampling with unequal
probabilities. \emph{Australian Journal of Statistics}, 5, 5-13.

Ohlsson, E. (1998). Sequential Poisson sampling. \emph{Journal of
Official Statistics}, 14(2), 149-162.

Rosen, B. (1997). On sampling with probability proportional to size.
\emph{Journal of Statistical Planning and Inference}, 62(2), 159-191.

Tille, Y. (2006). \emph{Sampling Algorithms}. Springer.
}
\seealso{
\code{\link[=unequal_prob_wr]{unequal_prob_wr()}} for with-replacement designs,
\code{\link[=equal_prob_wor]{equal_prob_wor()}} for equal probability designs,
\code{\link[=inclusion_prob]{inclusion_prob()}} to compute inclusion probabilities from size measures.
}
