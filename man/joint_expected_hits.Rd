% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R
\name{joint_expected_hits}
\alias{joint_expected_hits}
\alias{joint_expected_hits.wr}
\title{Joint Expected Hits}
\usage{
joint_expected_hits(x, ...)

\method{joint_expected_hits}{wr}(x, nsim = 10000L, ...)
}
\arguments{
\item{x}{A with-replacement design object (class \code{"wr"}).}

\item{...}{Additional arguments passed to methods (e.g., \code{nsim}
for simulation-based methods).}

\item{nsim}{Number of simulations for Chromy's pairwise expectations
(default 10000).}
}
\value{
A symmetric N x N matrix. Diagonal entries are
\eqn{E(n_i^2)} and off-diagonal entries are \eqn{E(n_i n_j)}.
}
\description{
Computes the matrix of pairwise expectations \eqn{E(n_i n_j)} for a
with-replacement sampling design, where \eqn{n_k} is the number of
times unit \eqn{k} is selected.
}
\details{
The computation depends on the sampling method:

\describe{
\item{Exact analytic}{\code{multinomial}
(\eqn{E(n_i n_j) = n(n-1) p_i p_j}) and \code{srs}
(\eqn{E(n_i n_j) = n(n-1)/N^2}).}
\item{Simulation-based}{\code{chromy}: pairwise expectations are
estimated by Monte Carlo simulation (controlled by the \code{nsim}
parameter, default 10 000). Increase \code{nsim} for more precise
estimates at the cost of computation time.}
}
}
\examples{
x <- c(40, 80, 50, 60, 70)
hits <- expected_hits(x, n = 3)
s <- unequal_prob_wr(hits, method = "chromy")
joint_expected_hits(s)

}
\seealso{
\code{\link[=joint_inclusion_prob]{joint_inclusion_prob()}} for the without-replacement analogue,
\code{\link[=sampling_cov]{sampling_cov()}} for the covariance matrix.
}
